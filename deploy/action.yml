name: "Build and publish Dotnet 6"
description: "Build and publish Dotnet 6 web apps"

inputs:
  destfolder:
    description: "folder under c:\\inetpub\\wwwroot"
    required: true
  sourcefolder:
    description: "name of the sourcefolder under d:\\Drop"
    required: true
  sitename:
    description: "name of the site"
    required: true
    
runs:
  using: "composite"
  steps:
    - name: Stop site
      run: c:\windows\system32\inetsrv\appcmd stop site ${{inputs.sitename}}
      shell: cmd
    - name: Stop pool
      run: c:\windows\system32\inetsrv\appcmd stop apppool ${{inputs.sitename}}
      shell: cmd
    - name: Deploy to IIS
      run: xcopy d:\Drop\${{inputs.sourcefolder}}\*.* C:\inetpub\wwwroot\${{inputs.destfolder}} /E /Y /H /R
      shell: cmd
    - name: Start pool
      run: c:\windows\system32\inetsrv\appcmd start apppool ${{inputs.sitename}}
      shell: cmd
    - name: Start site
      run: c:\windows\system32\inetsrv\appcmd start site ${{inputs.sitename}}
      shell: cmd
      
    
