name: "Build and publish Dotnet 6"
description: "Build and publish Dotnet 6 web apps"

inputs:
  destfolder:
    description: "folder under c:\\inetpub\\wwwroot"
    required: true
  sourcefolder:
    description: "name of the sourcefolder undr c:\\drop"
    required: true
runs:
  using: "composite"
  steps:
    - name: Take application offline
      run: New-Item -Type File -Name app_offline.htm -Path C:/inetpub/wwwroot/${{inputs.destfolder}} -Force
      shell: pwsh
    - name: Deploy to IIS
      run: Copy-Item c:/drop/@{{inputs.sourcefolder}}/* C:/inetpub/wwwroot/${{inputs.destfolder}} -Recurse -Force
      shell: pwsh
    - name: Bring the app back online
      run: Remove-Item C:/inetpub/wwwroot/${{inputs.destfolder}}\app_offline.htm
      shell: pwsh
    
